<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Downloading WRDS Data · WRDSMerger.jl</title><meta name="title" content="Downloading WRDS Data · WRDSMerger.jl"/><meta property="og:title" content="Downloading WRDS Data · WRDSMerger.jl"/><meta property="twitter:title" content="Downloading WRDS Data · WRDSMerger.jl"/><meta name="description" content="Documentation for WRDSMerger.jl."/><meta property="og:description" content="Documentation for WRDSMerger.jl."/><meta property="twitter:description" content="Documentation for WRDSMerger.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WRDSMerger.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Downloading WRDS Data</a><ul class="internal"><li><a class="tocitem" href="#Explore-WRDS"><span>Explore WRDS</span></a></li><li><a class="tocitem" href="#Compustat"><span>Compustat</span></a></li><li><a class="tocitem" href="#CRSP"><span>CRSP</span></a></li></ul></li><li><span class="tocitem">Links Between WRDS Data</span><ul><li><a class="tocitem" href="../basic_linking/">Linking Basics</a></li><li><a class="tocitem" href="../default_behavior/">Default Behavior</a></li><li><a class="tocitem" href="../linking_identifiers/">Identifier Types</a></li><li><a class="tocitem" href="../linking_internals/">Internals</a></li></ul></li><li><a class="tocitem" href="../misc_utilities/">Miscellaneous Utilities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Downloading WRDS Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Downloading WRDS Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/junder873/WRDSMerger.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/junder873/WRDSMerger.jl/blob/master/docs/src/download_data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Downloading-WRDS-Data"><a class="docs-heading-anchor" href="#Downloading-WRDS-Data">Downloading WRDS Data</a><a id="Downloading-WRDS-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Downloading-WRDS-Data" title="Permalink"></a></h1><h2 id="Explore-WRDS"><a class="docs-heading-anchor" href="#Explore-WRDS">Explore WRDS</a><a id="Explore-WRDS-1"></a><a class="docs-heading-anchor-permalink" href="#Explore-WRDS" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.list_libraries" href="#WRDSMerger.list_libraries"><code>WRDSMerger.list_libraries</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">list_libraries(conn::Union{LibPQ.Connection, DBInterface.Connection})</code></pre><p>Load the list of Postgres schemata the user has permission to access</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/exploreDB.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.list_tables" href="#WRDSMerger.list_tables"><code>WRDSMerger.list_tables</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">list_tables(conn::Union{LibPQ.Connection, DBInterface.Connection}, library::String)</code></pre><p>List all of the views/tables/foreign tables within a schema</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/exploreDB.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.describe_table" href="#WRDSMerger.describe_table"><code>WRDSMerger.describe_table</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">describe_table(conn::Union{LibPQ.Connection, DBInterface.Connection}, library::String, table::String)</code></pre><p>Get a table&#39;s description (row count, columns, column types)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/exploreDB.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.get_table" href="#WRDSMerger.get_table"><code>WRDSMerger.get_table</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_table(
                conn::Union{LibPQ.Connection, DBInterface.Connection},
                library::String,
                table::String;
                obs::Union{Nothing, Int} = nothing,
                offset::Int = 0,
                cols = nothing
            )</code></pre><p>Create a DataFrame from a table</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/exploreDB.jl#L98-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.raw_sql" href="#WRDSMerger.raw_sql"><code>WRDSMerger.raw_sql</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">raw_sql(
    conn::Union{LibPQ.Connection, DBInterface.Connection},
    query::String
)</code></pre><p>Executes raw sql code, and converts code to a DataFrame</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/exploreDB.jl#L130-L137">source</a></section></article><h2 id="Compustat"><a class="docs-heading-anchor" href="#Compustat">Compustat</a><a id="Compustat-1"></a><a class="docs-heading-anchor-permalink" href="#Compustat" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.comp_data" href="#WRDSMerger.comp_data"><code>WRDSMerger.comp_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function comp_data(
    conn::Union{LibPQ.Connection, DBInterface.Connection}[,
    gvkeys::AbstractArray{String},]
    dateStart::Union{Date,Int}=1950,
    dateEnd::Union{Date,Int}=Dates.today();
    annual::Bool=true,
    filters::Dict{String,&lt;:Any}=Dict(
        &quot;datafmt&quot; =&gt; &quot;STD&quot;,
        &quot;indfmt&quot; =&gt; &quot;INDL&quot;,
        &quot;consol&quot; =&gt; &quot;C&quot;,
        &quot;popsrc&quot; =&gt; &quot;D&quot;
    ),
    cols::Array{String}=[&quot;gvkey&quot;, &quot;datadate&quot;, &quot;fyear&quot;, &quot;sale&quot;, &quot;revt&quot;, &quot;xopr&quot;]
)</code></pre><p>Downloads data from Compustat for firms (if list of gvkeys is provided, filters to those firms) available firms over a period. Data can be annual (set <code>annual=true</code>) or quarterly (set <code>annual=false</code>). For quarterly data, you also likely need to change the columns that are downloaded (ie, sales is &quot;saleq&quot; in quarterly data).</p><p>Filters is a dictionary of String =&gt; String (or array of String) pairings that will be applied to the SQL query.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/compFunctions.jl#L38-L62">source</a></section></article><h2 id="CRSP"><a class="docs-heading-anchor" href="#CRSP">CRSP</a><a id="CRSP-1"></a><a class="docs-heading-anchor-permalink" href="#CRSP" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.crsp_stocknames" href="#WRDSMerger.crsp_stocknames"><code>WRDSMerger.crsp_stocknames</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function crsp_stocknames(
    conn::Union{LibPQ.Connection, DBInterface.Connection};
    cols::Array{String}=[&quot;permno&quot;, &quot;cusip&quot;, &quot;ncusip&quot;, &quot;comnam&quot;, &quot;namedt&quot;, &quot;nameenddt&quot;, &quot;ticker&quot;]
)

function crsp_stocknames(
    conn::Union{LibPQ.Connection, DBInterface.Connection},
    cusip::Array{String};
    cols::Array{String}=[&quot;permno&quot;, &quot;cusip&quot;, &quot;ncusip&quot;, &quot;comnam&quot;, &quot;namedt&quot;, &quot;nameenddt&quot;, &quot;ticker&quot;],
    cusip_col=&quot;cusip&quot;, # either &quot;cusip&quot; &quot;ncusip&quot; or &quot;ticker&quot;
)

function crsp_stocknames(
    conn::Union{LibPQ.Connection, DBInterface.Connection},
    permno::Array{&lt;:Number};
    cols::Array{String}=[&quot;permno&quot;, &quot;cusip&quot;, &quot;ncusip&quot;, &quot;comnam&quot;, &quot;namedt&quot;, &quot;nameenddt&quot;, &quot;ticker&quot;],
)</code></pre><p>Download crsp.stockname data (with non-missing ncusip). If an array of strings is passed, by default assumes it is a list of cusips, can be a list of ncusip or tickers (change <code>cusip_col</code>). Can also take an array of numbers which is assumed to be a list of permnos.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/crspFunctions.jl#L2-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.crsp_market" href="#WRDSMerger.crsp_market"><code>WRDSMerger.crsp_market</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function crsp_market(
    conn::Union{LibPQ.Connection, DBInterface.Connection},
    dateStart::Union{Date,Int}=1950,
    dateEnd::Union{Date,Int}=Dates.today();
    col::Union{String, Array{String}}=&quot;vwretd&quot;
)</code></pre><p>Downloads the data from the daily or monthly stock index file (dsi and msi) for a range of dates with one value for each day (with various return columns). Available columns are:</p><ul><li>&quot;vwretd&quot;: Value weighted return with dividends</li><li>&quot;vwretx&quot;: Value weighted return without dividends</li><li>&quot;ewretd&quot;: Equal weighted return with dividends</li><li>&quot;ewretx&quot;: Equal weighted return without dividends</li><li>&quot;sprtrn&quot;: S&amp;P500 return</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/crspFunctions.jl#L97-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.crsp_data" href="#WRDSMerger.crsp_data"><code>WRDSMerger.crsp_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function crsp_data(
    conn::Union{LibPQ.Connection, DBInterface.Connection},
    [permnos::Vector{&lt;:Real},]
    s::Date=Date(1925),
    e::Date=today();
    cols = [&quot;ret&quot;, &quot;vol&quot;, &quot;shrout&quot;],
    filters::Dict{String, &lt;:Any}=Dict{String, Any}(),
    adjust_crsp_data::Bool=true
)

function crsp_data(
    conn::Union{LibPQ.Connection, DBInterface.Connection},
    permnos::Vector{&lt;:Real},
    dates::Vector{Date},
    [dates_end::Vector{Date}];
    cols=[&quot;ret&quot;, &quot;vol&quot;, &quot;shrout&quot;],
    adjust_crsp_data::Bool=true,
    query_size_limit::Int=3000
)</code></pre><p>Downloads data from the crsp stockfiles, which are individual stocks. To download the data from the monthly stockfile, change the default table to the monthly stockfile:</p><pre><code class="language-julia hljs">WRDSMerger.default_tables[&quot;crsp_stock_data&quot;] = &quot;crsp.msf&quot;
WRDSMerger.default_tables[&quot;crsp_index&quot;] = &quot;crsp.msi&quot;
WRDSMerger.default_tables[&quot;crsp_delist&quot;] = &quot;crsp.msedelist&quot;</code></pre><p><strong>Arguments</strong></p><ul><li><code>permnos::Vecotr{&lt;:Real}</code>: A vector of firm IDs, if provided, will only download data for those firms</li><li><code>s::Date=Date(1925)</code> and <code>e::Date=today()</code>: Downloads all data between two dates provided</li><li><code>dates::Vector{Date}</code>: Downloads data for a set of permnos on the date provided<ul><li><code>dates_end::Vector{Date}</code>: If provided, then treats the <code>dates</code> as the start of a period and will download data for the permnos between the two dates</li></ul></li><li><code>adjust_crsp_data::Bool=true</code>: This will call <code>crsp_adjust</code> with all options   set to true, it will only do the operations that it has the data for.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/crspFunctions.jl#L192-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.crsp_delist" href="#WRDSMerger.crsp_delist"><code>WRDSMerger.crsp_delist</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function crsp_delist(
    conn::Union{LibPQ.Connection, DBInterface.Connection};
    cols::Array{String}=[
        &quot;permno&quot;,
        &quot;dlstdt&quot;,
        &quot;dlret&quot;
    ],
    date_start::Date=Date(1926),
    date_end::Date=today()
)</code></pre><p>Fetches the CRSP delist dataset, typically for the returns on the day of delisting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/crspFunctions.jl#L456-L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WRDSMerger.crsp_adjust" href="#WRDSMerger.crsp_adjust"><code>WRDSMerger.crsp_adjust</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function crsp_adjust(
    conn,
    df::DataFrame;
    kwargs...
)</code></pre><p>This makes 4 common adjustments to CRSP data:</p><ol><li>When the price in CRSP is negative, that means there was not a specific close price. Typically, researchers take the absolute value to get the actual price.</li><li>Prices are not adjusted for splits (returns are). CRSP includes the number (cfascpr) that will adjust prices to be comparable through time</li><li>Similar to prices, shares outstanding are not adjusted. The number used to adjust is different due to various events.</li><li>Prices are not adjusted for delisting, so this downloads the necessary dataset and adjusts returns accordingly.</li></ol><p><strong>Arguments</strong></p><p><strong>Options on what to adjust</strong></p><ul><li>adjust<em>prc</em>negatives::Bool=true: Corresponds to (1) above</li><li>adjust<em>prc</em>splits::Bool=true: Corresponds to (2) above</li><li>adjust<em>shr</em>splits::Bool=true: Corresponds to (3) above</li><li>adjust_delist::Bool=true: Corresponds to (4) above</li></ul><p><strong>Pre-existing column names</strong></p><ul><li>date::String=&quot;date&quot;: date column</li><li>idcol::String=&quot;permno&quot;: primary identifier (permno) column</li><li>prc_col::String=&quot;prc&quot;: price column</li><li>ret_col::String=&quot;ret&quot;: return column</li><li>prc<em>splits</em>col::String=&quot;cfacpr&quot;: price split adjustment factor</li><li>shrout_col::String=&quot;shrout&quot;: shares outstanding</li><li>shrout<em>splits</em>col::String=&quot;cfacshr&quot;: share split adjustment factor</li></ul><p><strong>Options to relabel columns</strong></p><ul><li>adjusted<em>neg</em>prc_col::String=&quot;prc&quot;: relabel prices to this after taking absolute value</li><li>adjusted<em>prc</em>col::String=&quot;prc_adj&quot;: relabel prices to this after adjusting for splits</li><li>adjusted<em>shrout</em>col::String=&quot;shrout_adj&quot;:relabel shares outstanding to this after adjusting for splits</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/e3e4c552381b3af1c9b78df1bc9400d4ac237df9/src/crspFunctions.jl#L492-L535">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../basic_linking/">Linking Basics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 15 February 2024 20:25">Thursday 15 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
