<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Miscellaneous Utilities · WRDSMerger.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WRDSMerger.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../download_data/">Downloading WRDS Data</a></li><li><span class="tocitem">Links Between WRDS Data</span><ul><li><a class="tocitem" href="../basic_linking/">Linking Basics</a></li><li><a class="tocitem" href="../default_behavior/">Default Behavior</a></li><li><a class="tocitem" href="../linking_identifiers/">Identifier Types</a></li><li><a class="tocitem" href="../linking_internals/">Internals</a></li></ul></li><li class="is-active"><a class="tocitem" href>Miscellaneous Utilities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Miscellaneous Utilities</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Miscellaneous Utilities</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/junder873/WRDSMerger.jl/blob/master/docs/src/misc_utilities.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="WRDSMerger.range_join" href="#WRDSMerger.range_join"><code>WRDSMerger.range_join</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function range_join(
    df1::DataFrame,
    df2::DataFrame,
    on,
    conditions::Array{Conditions};
    minimize=nothing,
    join_conditions::Union{Array{Symbol}, Symbol}=:and,
    validate::Tuple{Bool, Bool}=(false, false),
    jointype::Symbol=:inner
)</code></pre><p>Joins the dataframes based on a series of conditions, designed to work with ranges</p><p><strong>Arguments</strong></p><ul><li><code>df1::DataFrame</code>: left DataFrame</li><li><code>df2::DataFrame</code>: right DataFrame</li><li><code>on</code>: either array of column names or matched pairs</li><li><code>conditions::Array{Conditions}</code>: array of <code>Conditions</code>, which specifies the function (&lt;=, &gt;, etc.), left and right columns</li><li><code>jointype::Symbol=:inner</code>: type of join, options are :inner, :outer, :left, and :right</li><li><code>minimize</code>: either <code>nothing</code> or an array of column names or matched pairs, minimization will take place in order</li><li><code>join_conditions::Union{Array{Symbol}, Symbol}</code>: defaults to <code>:and</code>, otherwise an array of symbols that is 1 less than the length of conditions that the joins will happen in (:or or :and)</li><li><code>validate::Tuple{Bool, Bool}</code>: Whether to validate, this works differently than the equivalent in DataFrames joins, here, validate insures that a single row from the dataframe is not duplicated. So validate=(true, false) means that there are no duplicated rows from the left dataframe in the result.</li></ul><p><strong>Example</strong></p><pre><code class="nohighlight hljs">df1 = DataFrame(
    firm=1:10,
    date=Date.(2013, 1:10, 1:10)
)

df2 = df1[:, :]
df2[!, :date_low] = df2.date .- Day(2)
df2[!, :date_high] = df2.date .+ Day(2)
select!(df2, Not(:date))

range_join(
    df1,
    df2,
    [:firm],
    [
        Conditions(&lt;, :date, :date_high),
        Conditions(&gt;, :date, :date_low)
    ],
    join_conditions=[:and]
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/c7dd1958b600c41feae04936defe796268cf3591/src/utils.jl#L265-L318">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WRDSMerger.check_schema_perms" href="#WRDSMerger.check_schema_perms"><code>WRDSMerger.check_schema_perms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">check_schema_perms(conn::Union{LibPQ.Connection, DBInterface.Connection}, library::String)</code></pre><p>Verify that the user can access a schema</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/c7dd1958b600c41feae04936defe796268cf3591/src/exploreDB.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WRDSMerger.approx_row_count" href="#WRDSMerger.approx_row_count"><code>WRDSMerger.approx_row_count</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">approx_row_count(conn::Union{LibPQ.Connection, DBInterface.Connection}, library::String, table::String)</code></pre><p>Get an approximate count of the number of rows in a table</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/c7dd1958b600c41feae04936defe796268cf3591/src/exploreDB.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WRDSMerger.modify_col!" href="#WRDSMerger.modify_col!"><code>WRDSMerger.modify_col!</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>modify_col!</code> tries to identify the real type of a column, especially for strings that are actually dates or floats that are actually integers. Almost all data downloaded from WRDS correctly specifies dates, but all numbers are stored as float8, even items like <code>year</code> which should be an integer. This uses multiple dispatch to check if all elements in a given column are compatible with changing type and then changes the type of the column. Note that for strings this function does not by default try to convert integer like strings to integer (such as GVKey), it only converts strings that look like a date, datetime, or time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/WRDSMerger.jl/blob/c7dd1958b600c41feae04936defe796268cf3591/src/utils.jl#L61-L70">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linking_internals/">« Internals</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 20 April 2023 23:01">Thursday 20 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
